sum(abs(c1 - c2))
(1883+1843+1562)/3
c1 = c(39189,39592,41596)
c2 =c(39537,41123,41850
)
sum(abs(c1 - c2))
mean(c(5255,6794,5256,5251,5251,5251,5251,5251,5252,5252,5252,5252,5253,5253,5253,5253,5253,5253,3385
))
setwd("../../../testing_quickstart/zigzag/zigzag/quick_start_guide/")
install.packages("../../zigzag", type = "source", repos = NULL)
require(zigzag)
expression_data = read.table("example_lung.tpm", header = T, row.names = 1)
head(round(expression_data, digits = 1))
human_gene_lengths = read.table("example_gene_length.txt", header = T, row.names = 1)
head(round(human_gene_lengths, digits = 1))
plot(density(log(expression_data[,1])), main ="", xlab = "log Expression", ylim = c(0, 0.25))
for(i in seq(ncol(expression_data))) lines(density(log(expression_data[,i])))
abline(v = c(1, 4), lwd = c(2, 1), col = c("blue", "red"))
âˆ’
my_zigzag = zigzag$new(data = expression_data, gene_length = human_gene_lengths,
output_directory = "my_zigzag_output",
num_active_components = 2, threshold_a = c(1, 4))
my_zigzag$burnin(sample_frequency = 50, progress_plot = TRUE, write_to_files = TRUE, ngen=10000)
burn = read.table("example_zigzag_output/output_burnin/output_model_parameters.log", header = T, row.names for(i in seq(ncol(burn))) plot(burn[,i], type = "l", main = colnames(burn)[i])
burn = read.table("example_zigzag_output/output_burnin/output_model_parameters.log", header = T, row.names = 1)
for(i in seq(ncol(burn))) plot(burn[,i], type = "l", main = colnames(burn)[i])
plot(burn[,2], type = "l", main = colnames(burn)[2])
my_zigzag$mcmc(sample_frequency = 50, ngen = 50000, mcmcprefix = "human_lung")
mean(1130+4725+481+1463+901+921+884+829+903+925+770+773+665+702+746+1363)
mean(1130,4725,481,1463,901,921,884,829,903,925,770,773,665,702,746,1363)
mean(c(1130,4725,481,1463,901,921,884,829,903,925,770,773,665,702,746,1363))
mean(c(1763,720))
mean(c(2466,340,874))
mean(c(3803,3342,561,695,817,549))
sum(c(101,114,116,316))
post = read.table("example_zigzag_output/example_lung_mcmc_output/example_lung_model_parameters.log",
header = T, row.names = 1)
for(i in seq(ncol(post))) plot(post[,i], type = "l", main = colnames(post)[i])
hist(post$inactive_variance)
hist(post$inactive_variance, breaks = 20)
plot(post[,2], type = "l", main = colnames(post)[2])
Pr = read.table("example_zigzag_output/example_lung_mcmc_output/example_lung_probability_active.tab",
header = T, row.names = 1)
head(round(Pr, digits = 2))
library(zigzag)
dat <- read.table("../../../bitbucket_repos/nmix_data_files/gtex_data/subfile1_25libs_Lung_RNA.tpm", header=TRUE, row.names=1)
dat <- read.table("../../../bitbucket_repos/nmix_data_files/gtex_data/Amygdala_TruSeq.v1.tpm", header=TRUE, row.names=1)
dim(dat)
dat <- read.table("../../../bitbucket_repos/nmix_data_files/gtex_data/allgenes_RNA_Liver_RNASEQ.tpm", header=TRUE, row.names=1)
gene_length_df = read.table("../../../bitbucket_repos/nmix_data_files/gtex_data/allgenes_hg19_mean_length.txt", row.names = 1, header = FALSE)
dim(dat)
head(gene_length_df)
dim(gene_length_df)
hist(log(dat[,1]))
hist(log(dat[,1]), breaks = 100)
hist(log(dat[,2]), breaks = 100)
plot(density(log(dat[,1])))
for(i in 1:100) lines(density(log(dat[,i])))
dim(dat)
dat <- read.table("../../../bitbucket_repos/nmix_data_files/gtex_data/Amygdala_TruSeq.v1.tpm", header=TRUE, row.names=1)
plot(density(log(dat[,1])))
lines(density(log(dat[,1])), col  = "red")
bob = density(log(dat[,1]))
lines(bob$x, 0.2 8 bob$y, col = "red")
lines(bob$x, 0.2 * bob$y, col = "red")
lines(bob$x, 0.5 * bob$y, col = "red")
bob = density(log(dat[,2]))
lines(bob$x, 0.5 * bob$y, col = "red")
bob = density(log(dat[,3]))
lines(bob$x, 0.5 * bob$y, col = "red")
bob = density(log(dat[,34]))
lines(bob$x, 0.5 * bob$y, col = "red")
bob = density(log(dat[,45]))
lines(bob$x, 0.5 * bob$y, col = "red")
bob = density(log(dat[,46]))
lines(bob$x, 0.5 * bob$y, col = "red")
dat <- read.table("../../../bitbucket_repos/nmix_data_files/gtex_data/allgenes_Liver_RNASEQ.tpm", header=TRUE, row.names=1)
gene_length_df = read.table("../../../bitbucket_repos/nmix_data_files/gtex_data/allgenes_hg19_mean_length.txt", row.names = 1, header = FALSE)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_a = c(0), active_gene_set = NULL, shared_active_variances = T, beta = 1)
dim(gene_length_df)
dim(dat)
head(gene_length_df)
head(dat)
dim(dat)
plot(density(dat[,1]))
layout(1)
plot(density(log(dat[,1])))
alldat = dat
dat <- read.table("../../../bitbucket_repos/nmix_data_files/gtex_data/lincRNA_hs_liver.tpm", header=TRUE, row.names=1)
lines(density(log(dat[,1])), col = "red")
plot(density(log(dat[,1])))
for(i in 1:50) lines(density(log(dat[,i])))
hist(log(dat[,1]))
hist(log(dat[,1]), breaks = 100)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat[,1:4], gene_length = NULL, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_a = c(-1), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat[,1:4], gene_length = NULL, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_a = c(-1, 1), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat[,1:8], gene_length = NULL, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =1,
threshold_a = c(-1, 1), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat[,1:8], gene_length = NULL, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_a = c(-1, 1), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
mm$mcmc(sample_frequency = 50, progress_plot = F, write_to_files = T, ngen=50000, append = F,
run_posterior_predictive = T, mcmcprefix = "lincRNA")
layout(1)
mm$plotDensities()
pp =read.table("../testing/lincRNA_mcmc_output/lincRNA_probability_active.tab", header  = T, row.names = 1)
plot(mm$Yg, pp)
plot(mm$Yg, pp$prob_active)
hist(pp$prob_active)
hist(pp$prob_active, breaks = 100)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat[,1:8], gene_length = NULL, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =1,
threshold_a = c(-1, 1), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat[,1:8], gene_length = NULL, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =1,
threshold_i = -1, threshold_a = c(-2, 1), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
mm$mcmc(sample_frequency = 50, progress_plot = F, write_to_files = T, ngen=50000, append = F,
run_posterior_predictive = T, mcmcprefix = "lincRNA")
layout(1)
mm$plotDensities()
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat[,1:8], gene_length = NULL, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_i = -1, threshold_a = c(-2, 0), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
mm$mcmc(sample_frequency = 50, progress_plot = F, write_to_files = T, ngen=50000, append = F,
run_posterior_predictive = T, mcmcprefix = "lincRNA")
pp =read.table("../testing/lincRNA_mcmc_output/lincRNA_probability_active.tab", header  = T, row.names = 1)
plot(mm$Yg, pp$prob_active)
layout(1)
plot(mm$Yg, pp$prob_active)
mm$plotDensities()
hist(log(dat[,1]))
hist(log(dat[,1]),breaks = 1000)
hist(log(dat[,1]),breaks = 100)
dim(dat)
for(i in 1:10) hist(log(dat[i,]))
for(i in 1:10) hist(log(dat[i,] + 0.0001))
ndat = as.numeric(dat)
ndat = as.matrix(dat)
for(i in 1:10) hist(log(ndat[i,] + 0.0001))
for(i in which(pp$prob_active > 0.95)) hist(log(ndat[i,] + 0.0001))
for(i in which(pp$prob_active > 0.999)) hist(log(ndat[i,] + 0.0001))
hist(dat[,100], breaks = 100)
hist(log(dat[,100]), breaks = 100)
hist(log(dat[,120]), breaks = 100)
hist(log(dat[,121]), breaks = 100)
hist(log(rowMeans(dat)), breaks = 100)
plot(density(alldat[,1]))
plot(density(log(alldat[,1])))
lines(density(log(dat[,1])))
plot(density(log(alldat[,1])), ylim = c(0,0.1))
lines(density(log(dat[,1])))
for(i in 1:100) lines(density(log(dat[,i])), col = "red")
lines(density(log(alldat[,100])), lwd = 2)
dim(gene_length_df)
dim9dat
dim(dat)
dim(alldat)
sample(seq(ncol(alldat)), 10, replace = F)
sample(seq(ncol(alldat)), 10, replace = F)
abline(v=3)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = alldat[,sample(seq(ncol(alldat)), 10, replace = F)], gene_length = NULL, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_i = -1, threshold_a = c(0,3), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = alldat[,sample(seq(ncol(alldat)), 10, replace = F)], gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_i = -1, threshold_a = c(0,3), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
dim(gene_length_df)
cbind(row.names(dat), row.names(gene_length_df))
which(row.names(dat) == row.names(gene_length_df))
head(gene_length_df)
length(row.names(dat))
cbind(row.names(alldat), row.names(gene_length_df))
length(gene_length_df)
length(gene_length_df$V2)
length(alldat[,1])
head(alldat[,1])
head(alldat)
dat <- read.table("../../../bitbucket_repos/nmix_data_files/gtex_data/allgenes_liver_gtex.tpm", header=TRUE, row.names=1)
cbind(row.names(alldat), row.names(gene_length_df))
head(dat)
dim(alldat)
dim(gene_length_df)
head(gene_length_df)
tail(gene_length_df)
cbind(row.names(alldat), row.names(gene_length_df$V2))
cbind(row.names(alldat), row.names(gene_length_df))
cbind(row.names(alldat), row.names(gene_length_df)[-1])
tail(cbind(row.names(alldat), row.names(gene_length_df)[-1]))
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = alldat[,sample(seq(ncol(alldat)), 10, replace = F)], gene_length = gene_length_df$V2[-1], candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_i = -1, threshold_a = c(0,3), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
mm$mcmc(sample_frequency = 50, progress_plot = F, write_to_files = T, ngen=50000, append = F,
run_posterior_predictive = T, mcmcprefix = "allgenes")
layout(1)
mm$plotDensities()
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = alldat[,sample(seq(ncol(alldat)), 10, replace = F)], gene_length = gene_length_df$V2[-1], candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_i = -1, threshold_a = c(0,3), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm <- zigzag$new(data = alldat[1:1000,sample(seq(ncol(alldat)), 10, replace = F)], gene_length = gene_length_df$V2[-1][1:1000], candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_i = -1, threshold_a = c(0,3), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
?data
dim(dat)
dim gene_length_df
library(zigzag)
dat <- read.table("../simulate_data/simulated_data/sim3_twoComps_2mu3_nactive2500.tsv", header=TRUE, row.names=1)
gene_length_df = read.table("../simulate_data/simulated_data/sim3_twoComps_2mu3_gene_length.tsv", row.names = 1, header = FALSE)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_i = -1, threshold_a = c(0,3), active_gene_set = NULL, shared_active_variances = T, beta = 1)
hist(dat[,1])
layout(1)
hist(log(dat[,1]))
hist(log(dat[,1]), breaks = 100)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_i = -1, threshold_a = c(0), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2, active_mean_shape = 2,
threshold_i = -1, threshold_a = c(0), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2, active_means_dif_prior_shape = 2,
threshold_i = -1, threshold_a = c(0), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2, active_means_dif_prior_shape = 10,
threshold_i = -1, threshold_a = c(0), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
layout(1)
mm$plotDensities()
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2, active_means_dif_prior_shape = 10,
threshold_i = -1, threshold_a = c(0,2.5), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2, active_means_dif_prior_shape = 1,
threshold_i = -1, threshold_a = c(0,2.5), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2, active_means_dif_prior_shape = 1,
threshold_i = -1, threshold_a = c(0,2.75), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
mm$mcmc(sample_frequency = 50, progress_plot = F, write_to_files = T, ngen=50000, append = F,
run_posterior_predictive = T, mcmcprefix = "sim3")
layout(1)
hist(c(rnorm(0.15 * 2500, 3, 2), rnorm(0.85 * 2500, 2, 2)), breaks = 20)
hist(c(rnorm(0.15 * 2500, 3, 2), rnorm(0.85 * 2500, 2, 2)), breaks = 50)
hist(c(rnorm(0.15 * 2500, 4, 2), rnorm(0.85 * 2500, 2, 2)), breaks = 50)
hist(c(rnorm(0.15 * 2500, 6, 2), rnorm(0.85 * 2500, 2, 2)), breaks = 50)
hist(c(rnorm(0.5 * 2500, -2, 2), rnorm(0.5 * 2500, 2, 2)), breaks = 50)
hist(c(rnorm(0.15 * 2500, 3, sqrt(2)), rnorm(0.85 * 2500, 2, sqrt(2))), breaks = 50)
hist(c(rnorm(0.15 * 2500, 4, sqrt(2)), rnorm(0.85 * 2500, 2, sqrt(2))), breaks = 50)
hist(c(rnorm(0.2 * 2500, 3, sqrt(2)), rnorm(0.8 * 2500, 2, sqrt(2))), breaks = 50)
hist(c(rnorm(0.2 * 2500, 4, sqrt(2)), rnorm(0.8 * 2500, 2, sqrt(2))), breaks = 50)
hist(c(rnorm(0.2 * 2500, 6, sqrt(2)), rnorm(0.8 * 2500, 2, sqrt(2))), breaks = 50)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2, active_means_dif_prior_shape = 1,
threshold_i = -1, threshold_a = c(0,3), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
plot(dat[,1])
plot(log(dat[,1]))
layout(1)
plot(log(dat[,1]))
abline(h=c(-2,2,3), col = "red")
abline(v=0.5 + 0.5*0.85)
abline(v=5000*(0.5 + 0.5*0.85))
plot(density(log(dat[3000:4000,1])))
lines(density(log(dat[4500:5000,1])))
abline(v=c(2,3))
lines(density(log(dat[4800:5000,1])))
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2, active_means_dif_prior_shape = 1,
threshold_i = -1, threshold_a = c(1), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2, active_means_dif_prior_shape = 1,
threshold_i = -1, threshold_a = c(1, 2.5), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
mm$mcmc(sample_frequency = 50, progress_plot = F, write_to_files = T, ngen=50000, append = F,
run_posterior_predictive = T, mcmcprefix = "sim3")
library(zigzag)
# dat <- read.table("../../../bitbucket_repos/nmix_data_files/gtex_data/allgenes_liver_gtex.tpm", header=TRUE, row.names=1)
dat <- read.table("../simulate_data/simulated_data/sim3_twoComps_2mu3_nactive2500.tsv", header=TRUE, row.names=1)
gene_length_df = read.table("../simulate_data/simulated_data/sim3_twoComps_2mu3_gene_length.tsv", row.names = 1, header = FALSE)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2, active_means_dif_prior_shape = 1,
threshold_i = -1, threshold_a = c(0, 2.5), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
library(zigzag)
# dat <- read.table("../../../bitbucket_repos/nmix_data_files/gtex_data/allgenes_liver_gtex.tpm", header=TRUE, row.names=1)
dat <- read.table("../simulate_data/simulated_data/sim3_twoComps_2mu3_nactive2500.tsv", header=TRUE, row.names=1)
gene_length_df = read.table("../simulate_data/simulated_data/sim3_twoComps_2mu3_gene_length.tsv", row.names = 1, header = FALSE)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2, active_means_dif_prior_shape = 1,
threshold_i = -1, threshold_a = c(0, 2.5), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
library(zigzag)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
mm$mcmc(sample_frequency = 50, progress_plot = F, write_to_files = T, ngen=50000, append = F,
run_posterior_predictive = T, mcmcprefix = "sim3")
pdist = rep(1, 10)
pdist
pdist = pdist/(sum(pdist))
pdist
sum(pdist)
sum(log(pdist,2) * pdist)
-sum(log(pdist,2) * pdist)
log(pdsit,2)
log(pdist,2)
pdist2 = pdist
pdist2[1:8] = 0
pdist2[9:10] = 0.5
-sum(log(pdist2,2) * pdist2)
pdist2 = rep(1,10)
pdist2[9:10] =  1000
pdist2 = pdist2/sum(pdist2)
pdist2
-sum(log(pdist2,2) * pdist2)
-sum(log(pdist,2) * pdist)
pdist2 = rep(1,10)
pdist2[10] =  100000
pdist2 = pdist2/sum(pdist2)
-sum(log(pdist2,2) * pdist2)
mm$weight_within_active_alpha
dat <- read.table("../simulate_data/simulated_data/sim30_twoComps_2mu3_nactive2601.tsv", header=TRUE, row.names=1)
gene_length_df = read.table("../simulate_data/simulated_data/sim30_twoComps_2mu3_gene_length.tsv", row.names = 1, header = FALSE)
sq=rbind(c(1,2),c(3,4)); layout(sq)
layout(1)
hist(log(dat[,1]), breaks = 100)
plot(density(log(dat[,1])))
lines(density(log(dat[,2])))
lines(density(log(dat[,3])))
lines(density(log(dat[,4])))
abline(v=3)
abline(v=2.5)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2, active_means_dif_prior_shape = 1,
threshold_i = -1, threshold_a = c(0, 2.5), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
mm$mcmc(sample_frequency = 50, progress_plot = F, write_to_files = T, ngen=50000, append = F,
run_posterior_predictive = T, mcmcprefix = "sim30")
mm$mcmc(sample_frequency = 50, progress_plot = F, write_to_files = T, ngen=50000, append = F,
run_posterior_predictive = F, mcmcprefix = "sim30")
2^(1/3)
2/12.6
layout(1)
hist(rbeta(100000, 0.16, 12.6))
12.6*2
hist(rbeta(100000, 25.2, 12.6))
hist(rbeta(100000, 4000,2000))
hist(rgamma(100000, 4000,2000))
abline(v=2)
hist(rgamma(100000, 10000,5000))
10000/25000
10000/(5000^2)
hist(rgamma(100000, 2000,1000))
hist(1+rgamma(100000, 2000,1000))
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
active_means_dif_prior_shape = 2000, active_means_dif_prior_rate = 1000,
threshold_i = -1, threshold_a = c(0, 1), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
active_means_dif_prior_shape = 20000, active_means_dif_prior_rate = 10000,
threshold_i = -1, threshold_a = c(0, 1), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
mm$mcmc(sample_frequency = 50, progress_plot = F, write_to_files = T, ngen=50000, append = F,
run_posterior_predictive = F, mcmcprefix = "sim30")
layout(1)
plot(log(dat[,1]))
plot(log(dat[,1]), pch = 16, col = rgb(0,0,0,0.1))
plot(density(log(dat[0.263*5000:5000,1])))
plot(density(log(dat[(0.263*5000):5000,1])))
5000 - 0.263*5000
plot(density(log(dat[3685:5000,1])))
0.48*5000
lines(density(log(dat[2400:3685,1])))
plot(density(log(dat[3685:5000,2])))
lines(density(log(dat[2400:3685,2])))
mm$mcmc(sample_frequency = 50, progress_plot = F, write_to_files = T, ngen=50000, append = F,
run_posterior_predictive = T, mcmcprefix = "sim30")
# dat <- read.table("../../../bitbucket_repos/nmix_data_files/gtex_data/allgenes_liver_gtex.tpm", header=TRUE, row.names=1)
dat <- read.table("../simulate_data/simulated_data/sim31_twoComps_2mu3_nactive3054.tsv", header=TRUE, row.names=1)
gene_length_df = read.table("../simulate_data/simulated_data/sim31_twoComps_2mu3_gene_length.tsv", row.names = 1, header = FALSE)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
active_means_dif_prior_shape = 20000, active_means_dif_prior_rate = 10000,
threshold_i = -1, threshold_a = c(0, 1), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
mm$mcmc(sample_frequency = 50, progress_plot = F, write_to_files = T, ngen=50000, append = F,
run_posterior_predictive = T, mcmcprefix = "sim31")
layout(1)
mm$plotDensities()
library(zigzag)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
active_means_dif_prior_shape = 20000, active_means_dif_prior_rate = 10000,
threshold_i = -1, threshold_a = c(0, 1), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
microbenchmark::microbenchmark(mm$mhSigma_g())
microbenchmark::microbenchmark(mm$mhSigma_g())
microbenchmark::microbenchmark(mm$cmp_test_mhSigma_g())
microbenchmark::microbenchmark(mm$cmp_test_mhSigma_g())
library(zigzag)
bob = seq(10000)
idx = sample(seq(10000), 100, replace = F)
idx
microbenchmark::microbenchmark(bob[idx] = 2)
microbenchmark::microbenchmark(function(x){bob[idx] = 2})
bob = seq(100000)
idx = sample(seq(100000), 100, replace = F)
microbenchmark::microbenchmark(function(x){bob[idx] = 2})
mm$mhYg(recover_x = T)
choice_idx <- 1 + (log(runif(num_choice)) < R)
choice_matrix <- cbind(seq(num_choice), choice_idx)
dim(choice_matrix)
microbenchmark::microbenchmark(cbind(seq(num_choice), choice_idx))
microbenchmark::microbenchmark(.self$computeActiveLikelihood(Yg[out_spike_idx][active_outspike_idx],  allocation_within_active[[1]][out_spike_idx][active_outspike_idx],
active_means, active_variances))
microbenchmark::microbenchmark(cbind(matrix(Yg_trace[out_spike_idx,-1], nrow = length(out_spike_idx)), choice_idx - 1))
microbenchmark::microbenchmark(cbind(Yg_trace[out_spike_idx,-1], choice_idx - 1))
microbenchmark::microbenchmark(cbind(sigma_g_probability[out_spike_idx], proposed_sigmaGProbability))
bob = cbind(matrix(Yg_trace[out_spike_idx,-1], nrow = length(out_spike_idx)), choice_idx - 1)
dim(bob)
head(bob)
microbenchmark::microbenchmark(current_and_proposed[cbind(seq(num_choice), choice_idx)])
microbenchmark::microbenchmark(cbind(seq(num_choice), choice_idx))
microbenchmark::microbenchmark(cbind(sigma_g_probability[out_spike_idx], proposed_sigmaGProbability))
microbenchmark::microbenchmark(mm$mhYg())
microbenchmark::microbenchmark(mm$mhYg())
microbenchmark::microbenchmark(mm$mhSigma_g())
microbenchmark::microbenchmark(mm$mhSigma_g())
microbenchmark::microbenchmark(mm$mhSpikeAllocation())
microbenchmark::microbenchmark(mm$mhSpikeAllocation())
