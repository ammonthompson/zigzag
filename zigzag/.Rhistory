sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_a = c(0), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
plot(mm$Yg, mm$sigma_g)
plot(mm$Yg[mm$Yg > 0], mm$sigma_g[mm$Yg > 0])
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
plot(mm$Yg, mm$sigma_g)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
plot(mm$Yg, mm$sigma_g)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
plot(mm$Yg, mm$sigma_g)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
plot(mm$Yg, mm$sigma_g)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_a = c(0), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_a = c(0), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_a = c(0), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_a = c(0), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
hist(rnorm(10000, -1, 1))
hist(rnorm(10000, -1, .1))
hist(rgamma(10000, 1, 10))
library(zigzag)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_a = c(0), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
library(zigzag)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_a = c(0), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_a = c(0), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_a = c(0), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_a = c(0), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
library(zigzag)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_a = c(0), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_a = c(0), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_a = c(0), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
library(zigzag)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_a = c(0), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
library(zigzag)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_a = c(0), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_a = c(0), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_a = c(0), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_a = c(0), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
library(zigzag)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_a = c(0), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_a = c(0), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_a = c(0), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_a = c(0), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_a = c(0), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
library(zigzag)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_a = c(0), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_a = c(0), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_a = c(0), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_a = c(0), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_a = c(0), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_a = c(0), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_a = c(0), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
dat <- read.table("../../../bitbucket_repos/nmix_data_files/gtex_data/subfile1_25libs_Lung_RNA.tpm", header=TRUE, row.names=1)
gene_length_df = read.table("../../../bitbucket_repos/nmix_data_files/gtex_data/protCoding_GTEx_hg19_meanLength.txt", row.names = 1, header = FALSE)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_a = c(0), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
mm$mcmc(sample_frequency = 50, progress_plot = F, write_to_files = T, ngen=100000, append = F,
run_posterior_predictive = F, mcmcprefix = "sim85_t1")
mm$mcmc(sample_frequency = 50, progress_plot = F, write_to_files = T, ngen=100000, append = F,
run_posterior_predictive = T, mcmcprefix = "sim85_t1")
2081 - 85 - 150 - 50 - 25*12
10*12
microbenchmark::microbenchmark(c(rep(0,77), rep(1,23)))
bob seq(10)
bob = seq(10)
jim = bob
sam = bob
jim
sam
bob[2:5] = 234234
bob
sam
jim
?pandoc
erf(2)
install.packages("NORMT3")
library(NORMT3)
erf(1/(sqrt(2)))
erf(1/(sqrt(2))) * sqrt(pi/2)
3/sqrt(exp(1)) - erf(1/(sqrt(2))) * sqrt(pi/2)
1.5/2
605
605+321+119+428+28+20+128
c1 = c(11707,11295,11115,10616,8569,5943,5741)
c2 = c(12312,11616,11234,11044,8597,5963,5869)
sum(abs(c1 - c2))
c2 = c(1058609,1059009)
c1 = c(1057692,1058553)
sum(abs(c1 - c2))
1058609-1059009
1057692-1058553
c1 - c2
c2 - c1
c1 = c(127837,126478)
c2 = c(128624,127610)
sum(abs(c1 - c2))
3369+3011
6380/2
c1 = c(518979,519822,520028,521514,522011,523575,523825,524425,524647,524932,525278,526662
)
c2 = c(519198,519971,520063,521641,522069,523755,524046,524588,524877,525129,525391,526751
)
sum(abs(c1 - c2))
c1 = c(729950,726221,723972,723701,723484,723223,721794,720933,720617,720458,717832
)
c2 = c(730043,726788,724095,723884,723644,723420,723165,721739,720870,720556,719207
)
sum(abs(c1 - c2))
(1883+1843+1562)/3
c1 = c(39189,39592,41596)
c2 =c(39537,41123,41850
)
sum(abs(c1 - c2))
mean(c(5255,6794,5256,5251,5251,5251,5251,5251,5252,5252,5252,5252,5253,5253,5253,5253,5253,5253,3385
))
setwd("../../../testing_quickstart/zigzag/zigzag/quick_start_guide/")
install.packages("../../zigzag", type = "source", repos = NULL)
require(zigzag)
expression_data = read.table("example_lung.tpm", header = T, row.names = 1)
head(round(expression_data, digits = 1))
human_gene_lengths = read.table("example_gene_length.txt", header = T, row.names = 1)
head(round(human_gene_lengths, digits = 1))
plot(density(log(expression_data[,1])), main ="", xlab = "log Expression", ylim = c(0, 0.25))
for(i in seq(ncol(expression_data))) lines(density(log(expression_data[,i])))
abline(v = c(1, 4), lwd = c(2, 1), col = c("blue", "red"))
−
my_zigzag = zigzag$new(data = expression_data, gene_length = human_gene_lengths,
output_directory = "my_zigzag_output",
num_active_components = 2, threshold_a = c(1, 4))
my_zigzag$burnin(sample_frequency = 50, progress_plot = TRUE, write_to_files = TRUE, ngen=10000)
burn = read.table("example_zigzag_output/output_burnin/output_model_parameters.log", header = T, row.names for(i in seq(ncol(burn))) plot(burn[,i], type = "l", main = colnames(burn)[i])
burn = read.table("example_zigzag_output/output_burnin/output_model_parameters.log", header = T, row.names = 1)
for(i in seq(ncol(burn))) plot(burn[,i], type = "l", main = colnames(burn)[i])
plot(burn[,2], type = "l", main = colnames(burn)[2])
my_zigzag$mcmc(sample_frequency = 50, ngen = 50000, mcmcprefix = "human_lung")
mean(1130+4725+481+1463+901+921+884+829+903+925+770+773+665+702+746+1363)
mean(1130,4725,481,1463,901,921,884,829,903,925,770,773,665,702,746,1363)
mean(c(1130,4725,481,1463,901,921,884,829,903,925,770,773,665,702,746,1363))
mean(c(1763,720))
mean(c(2466,340,874))
mean(c(3803,3342,561,695,817,549))
sum(c(101,114,116,316))
post = read.table("example_zigzag_output/example_lung_mcmc_output/example_lung_model_parameters.log",
header = T, row.names = 1)
for(i in seq(ncol(post))) plot(post[,i], type = "l", main = colnames(post)[i])
hist(post$inactive_variance)
hist(post$inactive_variance, breaks = 20)
plot(post[,2], type = "l", main = colnames(post)[2])
Pr = read.table("example_zigzag_output/example_lung_mcmc_output/example_lung_probability_active.tab",
header = T, row.names = 1)
head(round(Pr, digits = 2))
library(zigzag)
dat <- read.table("../../../bitbucket_repos/nmix_data_files/gtex_data/subfile1_25libs_Lung_RNA.tpm", header=TRUE, row.names=1)
dat <- read.table("../../../bitbucket_repos/nmix_data_files/gtex_data/Amygdala_TruSeq.v1.tpm", header=TRUE, row.names=1)
dim(dat)
dat <- read.table("../../../bitbucket_repos/nmix_data_files/gtex_data/allgenes_RNA_Liver_RNASEQ.tpm", header=TRUE, row.names=1)
gene_length_df = read.table("../../../bitbucket_repos/nmix_data_files/gtex_data/allgenes_hg19_mean_length.txt", row.names = 1, header = FALSE)
dim(dat)
head(gene_length_df)
dim(gene_length_df)
hist(log(dat[,1]))
hist(log(dat[,1]), breaks = 100)
hist(log(dat[,2]), breaks = 100)
plot(density(log(dat[,1])))
for(i in 1:100) lines(density(log(dat[,i])))
dim(dat)
dat <- read.table("../../../bitbucket_repos/nmix_data_files/gtex_data/Amygdala_TruSeq.v1.tpm", header=TRUE, row.names=1)
plot(density(log(dat[,1])))
lines(density(log(dat[,1])), col  = "red")
bob = density(log(dat[,1]))
lines(bob$x, 0.2 8 bob$y, col = "red")
lines(bob$x, 0.2 * bob$y, col = "red")
lines(bob$x, 0.5 * bob$y, col = "red")
bob = density(log(dat[,2]))
lines(bob$x, 0.5 * bob$y, col = "red")
bob = density(log(dat[,3]))
lines(bob$x, 0.5 * bob$y, col = "red")
bob = density(log(dat[,34]))
lines(bob$x, 0.5 * bob$y, col = "red")
bob = density(log(dat[,45]))
lines(bob$x, 0.5 * bob$y, col = "red")
bob = density(log(dat[,46]))
lines(bob$x, 0.5 * bob$y, col = "red")
dat <- read.table("../../../bitbucket_repos/nmix_data_files/gtex_data/allgenes_Liver_RNASEQ.tpm", header=TRUE, row.names=1)
gene_length_df = read.table("../../../bitbucket_repos/nmix_data_files/gtex_data/allgenes_hg19_mean_length.txt", row.names = 1, header = FALSE)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat, gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_a = c(0), active_gene_set = NULL, shared_active_variances = T, beta = 1)
dim(gene_length_df)
dim(dat)
head(gene_length_df)
head(dat)
dim(dat)
plot(density(dat[,1]))
layout(1)
plot(density(log(dat[,1])))
alldat = dat
dat <- read.table("../../../bitbucket_repos/nmix_data_files/gtex_data/lincRNA_hs_liver.tpm", header=TRUE, row.names=1)
lines(density(log(dat[,1])), col = "red")
plot(density(log(dat[,1])))
for(i in 1:50) lines(density(log(dat[,i])))
hist(log(dat[,1]))
hist(log(dat[,1]), breaks = 100)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat[,1:4], gene_length = NULL, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_a = c(-1), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat[,1:4], gene_length = NULL, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_a = c(-1, 1), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat[,1:8], gene_length = NULL, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =1,
threshold_a = c(-1, 1), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat[,1:8], gene_length = NULL, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_a = c(-1, 1), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
mm$mcmc(sample_frequency = 50, progress_plot = F, write_to_files = T, ngen=50000, append = F,
run_posterior_predictive = T, mcmcprefix = "lincRNA")
layout(1)
mm$plotDensities()
pp =read.table("../testing/lincRNA_mcmc_output/lincRNA_probability_active.tab", header  = T, row.names = 1)
plot(mm$Yg, pp)
plot(mm$Yg, pp$prob_active)
hist(pp$prob_active)
hist(pp$prob_active, breaks = 100)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat[,1:8], gene_length = NULL, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =1,
threshold_a = c(-1, 1), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat[,1:8], gene_length = NULL, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =1,
threshold_i = -1, threshold_a = c(-2, 1), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
mm$mcmc(sample_frequency = 50, progress_plot = F, write_to_files = T, ngen=50000, append = F,
run_posterior_predictive = T, mcmcprefix = "lincRNA")
layout(1)
mm$plotDensities()
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = dat[,1:8], gene_length = NULL, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_i = -1, threshold_a = c(-2, 0), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
mm$mcmc(sample_frequency = 50, progress_plot = F, write_to_files = T, ngen=50000, append = F,
run_posterior_predictive = T, mcmcprefix = "lincRNA")
pp =read.table("../testing/lincRNA_mcmc_output/lincRNA_probability_active.tab", header  = T, row.names = 1)
plot(mm$Yg, pp$prob_active)
layout(1)
plot(mm$Yg, pp$prob_active)
mm$plotDensities()
hist(log(dat[,1]))
hist(log(dat[,1]),breaks = 1000)
hist(log(dat[,1]),breaks = 100)
dim(dat)
for(i in 1:10) hist(log(dat[i,]))
for(i in 1:10) hist(log(dat[i,] + 0.0001))
ndat = as.numeric(dat)
ndat = as.matrix(dat)
for(i in 1:10) hist(log(ndat[i,] + 0.0001))
for(i in which(pp$prob_active > 0.95)) hist(log(ndat[i,] + 0.0001))
for(i in which(pp$prob_active > 0.999)) hist(log(ndat[i,] + 0.0001))
hist(dat[,100], breaks = 100)
hist(log(dat[,100]), breaks = 100)
hist(log(dat[,120]), breaks = 100)
hist(log(dat[,121]), breaks = 100)
hist(log(rowMeans(dat)), breaks = 100)
plot(density(alldat[,1]))
plot(density(log(alldat[,1])))
lines(density(log(dat[,1])))
plot(density(log(alldat[,1])), ylim = c(0,0.1))
lines(density(log(dat[,1])))
for(i in 1:100) lines(density(log(dat[,i])), col = "red")
lines(density(log(alldat[,100])), lwd = 2)
dim(gene_length_df)
dim9dat
dim(dat)
dim(alldat)
sample(seq(ncol(alldat)), 10, replace = F)
sample(seq(ncol(alldat)), 10, replace = F)
abline(v=3)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = alldat[,sample(seq(ncol(alldat)), 10, replace = F)], gene_length = NULL, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_i = -1, threshold_a = c(0,3), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = alldat[,sample(seq(ncol(alldat)), 10, replace = F)], gene_length = gene_length_df, candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_i = -1, threshold_a = c(0,3), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
dim(gene_length_df)
cbind(row.names(dat), row.names(gene_length_df))
which(row.names(dat) == row.names(gene_length_df))
head(gene_length_df)
length(row.names(dat))
cbind(row.names(alldat), row.names(gene_length_df))
length(gene_length_df)
length(gene_length_df$V2)
length(alldat[,1])
head(alldat[,1])
head(alldat)
dat <- read.table("../../../bitbucket_repos/nmix_data_files/gtex_data/allgenes_liver_gtex.tpm", header=TRUE, row.names=1)
cbind(row.names(alldat), row.names(gene_length_df))
head(dat)
dim(alldat)
dim(gene_length_df)
head(gene_length_df)
tail(gene_length_df)
cbind(row.names(alldat), row.names(gene_length_df$V2))
cbind(row.names(alldat), row.names(gene_length_df))
cbind(row.names(alldat), row.names(gene_length_df)[-1])
tail(cbind(row.names(alldat), row.names(gene_length_df)[-1]))
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = alldat[,sample(seq(ncol(alldat)), 10, replace = F)], gene_length = gene_length_df$V2[-1], candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_i = -1, threshold_a = c(0,3), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
mm$mcmc(sample_frequency = 50, progress_plot = F, write_to_files = T, ngen=50000, append = F,
run_posterior_predictive = T, mcmcprefix = "allgenes")
layout(1)
mm$plotDensities()
sq=rbind(c(1,2),c(3,4)); layout(sq)
mm <- zigzag$new(data = alldat[,sample(seq(ncol(alldat)), 10, replace = F)], gene_length = gene_length_df$V2[-1], candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_i = -1, threshold_a = c(0,3), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm <- zigzag$new(data = alldat[1:1000,sample(seq(ncol(alldat)), 10, replace = F)], gene_length = gene_length_df$V2[-1][1:1000], candidate_gene_list = "random",
output_directory = "../testing", num_active_components =2,
threshold_i = -1, threshold_a = c(0,3), active_gene_set = NULL, shared_active_variances = T, beta = 1)
mm$burnin(sample_frequency = 20, burnin_target_acceptance_rate=0.44, progress_plot = T,
write_to_files = T, ngen=5000, append = F)
?data
dim(dat)
dim gene_length_df
